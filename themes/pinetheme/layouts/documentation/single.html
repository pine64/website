{{ define "main" }}

    {{- $style_docs := resources.Get "css/documentation.css" | minify | fingerprint -}}
    <link rel="stylesheet" href="{{ $style_docs.RelPermalink }}">

    <div id="doc-container">
        
        <div id="doc-nav">
            {{ partial "doc-nav.html" . }}
        </div>

        <div id="doc-page">
            {{ partial "breadcrumb.html" . }}

            <header>
                <h1>{{.Title}}</h1>
            </header>
            
            <!-- Content -->
            {{.Content}}

            {{ if .Params.fullnote }}
                {{ partial "fullnote.html" . }}
            {{ end }}
        
            <!-- partial "doc_previousnext.html" . -->
            {{ partial "doc_previousnext_custom.html" .}}

        </div>

        <div id="doc-toc">
            <!-- Full pages -->
            {{ if isset .Params "full_section" }}
                <nav id="TableOfContents">

                {{ $section := .Site.GetPage "section" (printf "/documentation/%s/" .Params.full_section) }}

                <!-- Set the filename variable -->
                {{ $filename := .File.Filename }}
            
                <div class="toc-head">Table of contents</div>

                <ul>
                {{ range $section.Pages.ByParam "menu.docs.weight"}}
                    <!-- Exclude self -->
                    {{ if not (eq .File.Filename $filename) }}
                        <li>
                            <a class="sidebar-nav-subitem" href="#{{ .Title | anchorize }}">{{ .Title }}</a>
                            <!-- not if "toc: false" is set-->
                            {{ if not (eq .Params.toc false) }}
                                <!-- Length limit -->
                                {{ if lt (.TableOfContents | len ) 800 }}
                                    {{ .TableOfContents }}
                                {{ end }}
                            {{ end }}
                        </li>
                   {{ end }}
                {{ end }}
                </ul>

                </nav>
            <!-- Regular doc pages -->
            {{ else }}
                {{ if ge (len (.TableOfContents)) 33 -}}
                    <div class="toc-head">Table of contents</div>
                    {{ $tocStartLevel := 2 }}
                    {{ $tocDepth := default 2 .Params.toc_depth }}
                    {{ $tocEndLevel := add $tocStartLevel (sub $tocDepth 1) }}
                    {{ $tocOrdered := false  }}
                    {{ .Fragments.ToHTML $tocStartLevel $tocEndLevel $tocOrdered | safeHTML }}
                {{ end }}
            {{ end }}

        </div>
        
    </div>
{{ end }}